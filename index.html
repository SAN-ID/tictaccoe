<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Coe by San â€” Glitch Core v4</title>

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap">

<style>
  /* Palet Warna & Variabel Umum */
  :root {
    --bg-color-dark: #00000a;
    --bg-color-light: #1a0033;
    --text-color: #f0f0f0;
    --primary-color: #ff33ff; /* Magenta Neon */
    --success-color: #00f9a9; /* Hijau Neon (X) */
    --warning-color: #00ffff; /* Cyan Neon (O) */
    --board-bg: rgba(255, 255, 255, 0.08);
    --border-color-glow: #ff33ff;
    --hover-bg: rgba(255, 255, 255, 0.18);
    --glow-intensity: 0 0 15px;
    --star-color: rgba(255, 255, 255, 0.7);
  }

  body {
    background: linear-gradient(135deg, var(--bg-color-dark) 0%, var(--bg-color-light) 100%);
    overflow: hidden;
    font-family: 'Press Start 2P', cursive, 'Arial Black', sans-serif;
    color: var(--text-color);
    height: 100vh;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  /* Overlay Scanlines */
  body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
      transparent 0,
      rgba(0, 0, 0, 0.3) 1px,
      transparent 2px
    );
    pointer-events: none;
    z-index: 1000;
  }

  /* Efek Background: Partikel Bintang Bergerak */
  .stars {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 0;
    pointer-events: none;
  }
  .star {
    position: absolute;
    background: var(--star-color);
    border-radius: 50%;
    opacity: 0;
    animation: star-fall linear infinite;
  }
  @keyframes star-fall {
    0% { transform: translateY(100vh); opacity: 0; }
    5% { opacity: 1; }
    95% { opacity: 1; }
    100% { transform: translateY(-100vh); opacity: 0; }
  }

  /* Overlay Garis Grid Statis */
  .grid-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
      linear-gradient(to right, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
    background-size: 50px 50px;
    pointer-events: none;
    z-index: 1;
    opacity: 0.5;
  }


  /* Judul Utama */
  .main-title-container {
    margin-bottom: 30px;
    text-align: center;
    position: relative;
    user-select: none;
    animation: fadeInDown 0.8s ease;
    z-index: 10;
  }

  h1.main-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 5.5rem;
    letter-spacing: 5px;
    color: transparent;
    -webkit-text-stroke: 2px var(--primary-color);
    text-shadow: var(--glow-intensity) var(--primary-color);
    position: relative;
    display: inline-block;
    margin: 0;
    padding: 0;
    line-height: 1;
  }

  /* Efek Shimmer pada Judul Utama (Hanya untuk "Tic Tac Coe") */
  h1.main-title::before {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 100%;
    color: var(--primary-color);
    overflow: hidden;
    white-space: nowrap;
    -webkit-text-stroke: 0px;
    text-shadow: var(--glow-intensity) var(--primary-color);
    animation: shimmer 4s infinite linear;
    z-index: 2; /* Di atas after glitch */
  }

  @keyframes shimmer {
    0% { width: 0; }
    30% { width: 100%; }
    70% { width: 100%; }
    100% { width: 0; }
  }

  .subtitle {
    font-family: 'Press Start 2P', cursive;
    font-size: 0.8rem;
    color: var(--text-color);
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
    margin-top: 5px;
    letter-spacing: 1px;
    font-weight: normal;
    animation: fadeIn 1s ease 0.5s forwards;
    opacity: 0;
  }
  
  /* Efek Glitch pada Judul (Hanya untuk "Tic Tac Coe") */
  h1.main-title::after {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    width: 100%; 
    height: 100%;
    clip: rect(0, 0, 0, 0);
    opacity: 0.7;
    font-size: 5.5rem;
    letter-spacing: 5px;
    font-family: 'Bebas Neue', sans-serif;
    line-height: 1;
    color: var(--success-color);
    animation: glitch-effect 5s infinite linear alternate-reverse;
    text-shadow: none;
    z-index: 1; /* Di bawah before shimmer */
  }

  @keyframes glitch-effect {
    0% { transform: translate(3px, 3px); clip: rect(20px, 9999px, 40px, 0); }
    10% { transform: translate(-3px, -3px); clip: rect(0px, 9999px, 20px, 0); }
    20% { transform: translate(3px, -3px); clip: rect(60px, 9999px, 80px, 0); }
    30% { transform: translate(-3px, 3px); clip: rect(40px, 9999px, 60px, 0); }
    40% { transform: translate(0, 0); clip: rect(0, 9999px, 9999px, 0); }
    100% { transform: translate(0, 0); clip: rect(0, 9999px, 9999px, 0); }
  }

  /* Papan Permainan */
  #board {
    display: grid;
    grid-template-columns: repeat(3, 110px);
    grid-gap: 15px;
    transform: perspective(800px) rotateX(15deg) rotateZ(0deg); 
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.8), 0 0 40px var(--primary-color);
    padding: 15px;
    background: rgba(0, 0, 0, 0.6);
    border-radius: 10px;
    border: 2px solid var(--border-color-glow);
    z-index: 10;
  }

  .square {
    width: 110px;
    height: 110px;
    background: var(--board-bg);
    border: 3px solid var(--border-color-glow);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 0 0 8px rgba(0,0,0,0.5), 0 0 10px rgba(255,255,255,0.1);
    user-select: none;
  }

  .square:not(.X):not(.O):hover {
    background: var(--hover-bg);
    transform: scale(1.05);
    box-shadow: inset 0 0 8px rgba(0,0,0,0.5), 0 0 20px var(--primary-color);
  }

  .square.X { 
    color: var(--success-color); 
    text-shadow: var(--glow-intensity) var(--success-color); 
    border-color: var(--success-color);
  }
  .square.O { 
    color: var(--warning-color); 
    text-shadow: var(--glow-intensity) var(--warning-color); 
    border-color: var(--warning-color);
  }

  .square.win {
    background: rgba(255, 255, 255, 0.25);
    animation: glowWin 1s infinite alternate;
  }

  @keyframes glowWin {
    from { box-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color); }
    to { box-shadow: 0 0 25px var(--primary-color), 0 0 40px var(--primary-color); }
  }

  #message {
    margin-top: 30px;
    font-size: 1.4rem;
    font-weight: bold;
    min-height: 35px;
    text-shadow: 0 0 5px var(--text-color);
    position: relative;
    width: 100%;
    text-align: center;
    z-index: 10;
  }

  .animated-text > span {
    display: inline-block;
    animation: bounce 0.5s ease-out infinite alternate;
  }
  @keyframes bounce {
    from { transform: translateY(0); }
    to { transform: translateY(-3px); }
  }
  .animated-text > span:nth-child(even) { animation-delay: 0.1s; }
  .animated-text > span:nth-child(3n) { animation-delay: 0.2s; }
  
  .endgame-text { 
    font-size: 3.5rem;
    font-weight: 900;
    line-height: 1.2;
    text-transform: uppercase;
    animation: pulse 1s infinite alternate;
    font-family: 'Press Start 2P', cursive;
  }
  .win-msg { color: var(--success-color); text-shadow: var(--glow-intensity) var(--success-color); }
  .lose-msg { color: var(--primary-color); text-shadow: var(--glow-intensity) var(--primary-color); }

  @keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.08); opacity: 0.9; }
    100% { transform: scale(1); opacity: 1; }
  }

  .thinking {
    color: var(--warning-color);
    font-style: italic;
  }
  .thinking::after {
    content: " . . .";
    animation: dots 1.2s infinite steps(3, end);
  }
  @keyframes dots {
    0%, 20% { content: "."; }
    40%, 60% { content: ".."; }
    80%, 100% { content: "..."; }
  }

  #reset-btn {
    margin-top: 25px;
    background: var(--primary-color);
    border: 2px solid var(--text-color);
    color: var(--text-color);
    padding: 15px;
    border-radius: 50%;
    cursor: pointer;
    font-weight: bold;
    font-size: 1.5rem;
    line-height: 1;
    transition: 0.3s ease;
    text-shadow: 0 0 5px #000;
    box-shadow: 0 0 15px var(--primary-color);
    width: 60px;
    height: 60px;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10;
  }

  #reset-btn:hover {
    background: #ff66ff;
    transform: rotate(360deg) scale(1.1);
    box-shadow: 0 0 25px #ff66ff;
  }
</style>
</head>
<body>

<div class="stars"></div> 
<div class="grid-overlay"></div> 
<div class="main-title-container">
  <h1 class="main-title" data-text="Tic Tac Coe">Tic Tac Coe</h1>
  <div class="subtitle">by San</div>
</div>

<div id="board">
  <div class="square" data-index="0"></div>
  <div class="square" data-index="1"></div>
  <div class="square" data-index="2"></div>
  <div class="square" data-index="3"></div>
  <div class="square" data-index="4"></div>
  <div class="square" data-index="5"></div>
  <div class="square" data-index="6"></div>
  <div class="square" data-index="7"></div>
  <div class="square" data-index="8"></div>
</div>

<div id="message">Siap tempur, Bos? <span class="player-indicator">(X)</span></div>
<button id="reset-btn">â†»</button>

<script>
// Logic JavaScript dipastikan berada di dalam DOMContentLoaded agar semua elemen HTML tersedia.

document.addEventListener('DOMContentLoaded', () => {
    const squares = document.querySelectorAll('.square');
    const msg = document.getElementById('message');
    const resetBtn = document.getElementById('reset-btn');
    const starsContainer = document.querySelector('.stars');

    let board = Array(9).fill(null);
    const HUMAN = 'X';
    const AI = 'O';
    let currentTurn = HUMAN;
    let gameActive = true;
    let spamTimer = null; 

    const WIN_COMBOS = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];

    const WIN_EMOJIS = ['ğŸ¥³', 'âœ¨', 'ğŸ†', 'ğŸ”¥', 'ğŸ‘‘', 'ğŸ‰', 'ğŸŒŸ', 'ğŸš€'];
    const LOSE_EMOJIS = ['ğŸ˜­', 'ğŸ’€', 'ğŸ¤¡', 'ğŸ¥²', 'ğŸ’”', 'ğŸ‘', 'ğŸ—‘ï¸', 'ğŸ›‘'];
    const DRAW_EMOJIS = ['ğŸ¤', 'ğŸ˜¶', 'ğŸ’¤', 'ğŸ¤·', 'ğŸ˜', 'ğŸ¤”'];

    // FUNGSI BACKGROUND: GENERASI BINTANG
    function createStars(numStars) {
        for (let i = 0; i < numStars; i++) {
            const star = document.createElement('div');
            star.classList.add('star');
            star.style.width = star.style.height = `${Math.random() * 3 + 1}px`;
            star.style.left = `${Math.random() * 100}vw`;
            star.style.animationDuration = `${Math.random() * 5 + 5}s`;
            star.style.animationDelay = `${Math.random() * -10}s`;
            starsContainer.appendChild(star);
        }
    }


    function checkWin(player, currentBoard) {
      const combo = WIN_COMBOS.find(c => c.every(i => currentBoard[i] === player));
      return combo || null;
    }
    function checkDraw(bd){ return bd.every(c=>c!==null); }
    function getMoves(bd){ return bd.map((v,i)=>v?null:i).filter(i=>i!==null); }

    function minimax(newBoard, depth, isMax){
      const aiWin = checkWin(AI,newBoard);
      const huWin = checkWin(HUMAN,newBoard);
      if(aiWin) return {score:10-depth};
      if(huWin) return {score:depth-10};
      if(checkDraw(newBoard)) return {score:0};

      let best = {score:isMax?-Infinity:Infinity};
      const moves = getMoves(newBoard);

      for(const move of moves){
        newBoard[move]=isMax?AI:HUMAN;
        const val=minimax(newBoard,depth+1,!isMax);
        newBoard[move]=null;
        if(isMax?val.score>best.score:val.score<best.score)
          best={score:val.score,index:move};
      }
      return best;
    }

    function bestMove(){ return minimax([...board],0,true).index; }

    function highlightWin(combo){
      combo.forEach(i=>squares[i].classList.add('win'));
    }

    function animateText(text, player, type) {
        const words = text.split(' ');
        let html = '';
        
        let emojiArray = [];
        if (type === 'WIN') emojiArray = WIN_EMOJIS;
        else if (type === 'LOSE') emojiArray = LOSE_EMOJIS;
        else if (type === 'DRAW') emojiArray = DRAW_EMOJIS;
        
        if (type === 'TURN') {
            html = words.map(word => `<span style="animation-duration: ${Math.random() * 0.2 + 0.3}s">${word}</span>`).join(' ');
            html += ` <span class="player-indicator">(${player})</span>`;
            msg.classList.add('animated-text');
            msg.classList.remove('endgame-text', 'win-msg', 'lose-msg');
            msg.innerHTML = html;
            return;
        } 
        
        else {
            msg.classList.remove('animated-text', 'thinking');
            
            const mainText = `<span class="${type === 'WIN' ? 'win-msg' : (type === 'LOSE' ? 'lose-msg' : '')}">${words.join(' ')}</span>`;
            msg.innerHTML = mainText;
            msg.classList.add('endgame-text');

            let count = 0;
            const spamFunc = () => {
                if (!gameActive && count < 100) {
                    const emoji = emojiArray[Math.floor(Math.random() * emojiArray.length)];
                    const size = Math.random() * 2 + 1.5;
                    const x = Math.random() * (window.innerWidth + 200) - window.innerWidth / 2 - 100;
                    const y = Math.random() * (window.innerHeight + 200) - window.innerHeight / 2 - 100;

                    const spamElement = document.createElement('div');
                    spamElement.textContent = emoji;
                    spamElement.style.cssText = `
                        position: fixed;
                        left: 50%;
                        top: 50%;
                        transform: translate(${x}px, ${y}px) rotate(${Math.random() * 360}deg);
                        font-size: ${size}rem;
                        opacity: ${Math.random() * 0.8 + 0.2};
                        pointer-events: none;
                        transition: opacity 1s ease-out, transform 1s ease-out;
                        z-index: 99999;
                    `;
                    document.body.appendChild(spamElement);

                    setTimeout(() => {
                        spamElement.style.opacity = '0';
                        spamElement.style.transform = `translate(${x * 1.5}px, ${y * 1.5}px) rotate(${Math.random() * 720}deg)`;
                        setTimeout(() => { document.body.removeChild(spamElement); }, 1000);
                    }, 500);
                    count++;
                }
            };

            if (spamTimer) clearInterval(spamTimer);
            spamTimer = setInterval(spamFunc, 70);

            setTimeout(() => {
                clearInterval(spamTimer);
                spamTimer = null;
            }, 5000);
        }
    }


    function endGame(result, combo, winner) {
      gameActive = false;
      squares.forEach(s=>s.style.pointerEvents='none');
      
      if (winner === HUMAN) {
        animateText(result, null, 'WIN');
      } else if (winner === AI) {
        animateText(result, null, 'LOSE');
      } else {
        animateText(result, null, 'DRAW');
      }

      if(combo) highlightWin(combo);
    }

    function aiTurn(){
      currentTurn=AI;
      msg.textContent='San sedang mikir keras... ğŸ§ ';
      msg.classList.add('thinking');
      msg.classList.remove('animated-text', 'endgame-text', 'win-msg', 'lose-msg');
      
      setTimeout(()=>{
        if(!gameActive) return;
        msg.classList.remove('thinking');
        const move=bestMove();
        
        if(move!==undefined){
          board[move]=AI;
          const sq=squares[move];
          sq.textContent=AI;
          sq.classList.add(AI);
          sq.animate([{transform:'scale(0.8)', opacity:0},{transform:'scale(1.05)', opacity:1},{transform:'scale(1)'}],{duration:250, easing:'ease-out'});
          
          const win=checkWin(AI,board);
          if(win) endGame('CUPU!! (San menang bos) Coba lagi, bro!', win, AI); 
          else if(checkDraw(board)) endGame('SERI! Hujan-hujanan, Gan!', null, 'DRAW');
          else {
            currentTurn=HUMAN; 
            animateText('Giliran Anda! Pilih yang jago!', HUMAN, 'TURN');
          }
        }
      },700);
    }

    function handleClick(e){
      const i=e.target.dataset.index;
      if(!gameActive||board[i]||currentTurn!==HUMAN) return;
      
      board[i]=HUMAN;
      e.target.textContent=HUMAN;
      e.target.classList.add(HUMAN);
      e.target.animate([{transform:'scale(0.8)', opacity:0},{transform:'scale(1.05)', opacity:1},{transform:'scale(1)'}],{duration:250, easing:'ease-out'});
      
      const win=checkWin(HUMAN,board);
      if(win) endGame('WANJIR SEPUH!! (Anda menang) GG, Bos!', win, HUMAN); 
      else if(checkDraw(board)) endGame('Seri ah ga seru ah', null, 'DRAW');
      else aiTurn();
    }

    function reset(){
      if (spamTimer) clearInterval(spamTimer);
      spamTimer = null;

      board.fill(null);
      currentTurn=HUMAN;
      gameActive=true;
      
      animateText('Siap tempur, Bos?', HUMAN, 'TURN'); 

      msg.classList.remove('win-msg', 'lose-msg', 'thinking', 'endgame-text');
      squares.forEach(s=>{
        s.textContent='';
        s.className='square';
        s.style.pointerEvents='auto';
      });
    }

    // INISIALISASI
    createStars(50); 
    squares.forEach(s=>s.addEventListener('click',handleClick));
    resetBtn.addEventListener('click',reset);
    reset(); 
});
</script>
</body>
</html>
